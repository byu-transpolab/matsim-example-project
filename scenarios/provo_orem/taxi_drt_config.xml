<?xml version="1.0" ?>
<!DOCTYPE config SYSTEM "http://www.matsim.org/files/dtd/config_v2.dtd">
<config>
	<module name="dvrp">
		<!-- Mode of which the network will be used for routing vehicles, calculating travel times etc. (fleet operator's perspective).
					If null, no mode filtering is done; the standard network (Scenario.getNetwork()) is used - usually, car -->
		<param name="networkModes" value="car"/>
	</module>

	<module name="taxifares">
		<!-- Define a parameterset for each taxi mode where fares should be charged -->
		<parameterset type="taxifare">
			<param name="mode" value="taxi"/>
			<!-- transport mode for which this fare applies. Default: taxi -->
			<param name="basefare" value="0.5"/>
			<!-- Daily subscription fee (fee = positive value) -->
			<param name="dailySubscriptionFee" value="0.0"/>
			<!-- taxi fare per meter (fee = positive value) -->
			<param name="distanceFare_m" value="0.0002"/>
			<!-- taxi fare per hour (fee = positive value) -->
			<param name="timeFare_h" value="3.6"/>
			<!-- Minimum fare per trip (paid instead of the sum of base, time and distance fare if that sum would be lower than the minimum fare, fee = positive value). -->
			<param name="minFarePerTrip" value="2.0"/>
		</parameterset>
	</module>

	<module name="multiModeTaxi">
		<parameterset type="taxi">
			<!-- Used in AStarEuclidean for shortest path search for occupied drives.
				Values above 1.0 (typically, 1.5 to 3.0) speed up the search, but at the
				cost of obtaining longer paths
			<param name="AStarEuclideanOverdoFactor" value="1.0"/>-->
			<param name="breakIfNotAllRequestsServed" value="false"/>
			<param name="changeStartLinkToLastLinkInSchedule" value="true"/>
			<!-- If false, the drop-off location remains unknown to the optimizer and
				scheduler until the end of pickup -->
			<param name="destinationKnown" value="false"/>
			<!-- If true, detailed hourly taxi stats are dumped after each iteration. -->
			<param name="detailedStats" value="true"/>
			<!-- Typically, 60 seconds -->
			<param name="dropoffDuration" value="60.0"/>
			<!-- If true, vehicles are (GPS-like) monitored while moving. This helps
				in getting more accurate estimates on the time of arrival. Online tracking
				is necessary for vehicle diversion. -->
			<param name="onlineVehicleTracker" value="false"/>
			<!-- Typically, 120 seconds -->
			<param name="pickupDuration" value="120.0"/>
			<!-- An XML file specifying the taxi fleet. The file format according to
				dvrp_vehicles_v1.dtd -->
			<!-- To create your own vehicles, see org.matsim.contrib.av.vehicles.CreateTaxiVehicles  -->
			<!--  <param name="taxisFile" value="taxis_5000.xml"/>  -->
			<param name="taxisFile" value="taxi_vehicles.xml" />
			<!-- If true, time profiles of vehicle statuses (i.e. current task type)
				and the number of unplanned requests -->
			<param name="timeProfiles" value="true"/>
			<!-- If true, vehicles can be diverted during empty trips. Requires online
				tracking. -->
			<param name="vehicleDiversion" value="false"/>

			<!--different optimizers can be used to run the taxi portion-->
			<!--<parameterset type="AssignmentTaxiOptimizer"/>-->
			<parameterset type="RuleBasedTaxiOptimizer"/>
		</parameterset>
	</module>

	<module name="drtfares">
		<!-- Define a parameterset for each drt mode where fares should be charged -->
		<parameterset type="drtfare">
			<param name="mode" value="drt"/>
			<!-- transport mode for which this fare applies. Default: drt -->
			<param name="basefare" value="0.25"/>
			<!-- Daily subscription fee (fee = positive value) -->
			<param name="dailySubscriptionFee" value="0.0"/>
			<!-- drt fare per meter (fee = positive value) -->
			<param name="distanceFare_m" value="0.0001"/>
			<!-- drt fare per hour (fee = positive value) -->
			<param name="timeFare_h" value="3.6"/>
			<!-- Minimum fare per trip (paid instead of the sum of base, time and distance fare if that sum would be lower than the minimum fare, fee = positive value). -->
			<param name="minFarePerTrip" value="1.0"/>
		</parameterset>
	</module>

	<module name="multiModeDrt">
		<parameterset type="drt">
			<parameterset type="ExtensiveInsertionSearch"/>
			<!-- If true, the startLink is changed to last link in the current schedule, so the taxi starts the next day at the link where it stopped operating the day before. False by default. -->
			<param name="changeStartLinkToLastLinkInSchedule" value="false"/>
			<!-- Beeline distance factor for DRT. Used in analyis and in plans file. The default value is 1.3. -->
			<param name="estimatedBeelineDistanceFactor" value="1.3"/>
			<!-- Beeline-speed estimate for DRT. Used in analysis, optimisation constraints and in plans file, [m/s]. The default value is 25 km/h -->
			<param name="estimatedDrtSpeed" value="8.333333333333334"/>
			<!-- Defines the slope of the maxTravelTime estimation function (optimisation constraint), i.e. maxTravelTimeAlpha * estimated_drt_travel_time + maxTravelTimeBeta. Alpha should not be smaller than 1. -->
			<param name="maxTravelTimeAlpha" value="1.5"/>
			<!-- Defines the shift of the maxTravelTime estimation function (optimisation constraint), i.e. maxTravelTimeAlpha * estimated_drt_travel_time + maxTravelTimeBeta. Beta should not be smaller than 0. -->
			<param name="maxTravelTimeBeta" value="1200.0"/>
			<!-- Max wait time for the bus to come (optimisation constraint). -->
			<param name="maxWaitTime" value="1200.0"/>
			<!-- Maximum walk distance to next stop location in stationbased system. -->
			<param name="maxWalkDistance" value="1500.0"/>

			<!-- Operational Scheme, either door2door or stopbased. door2door by default -->
			<!--<param name="operationalScheme" value="door2door"/>-->
			<param name="operationalScheme" value="stopbased"/>

			<!-- Bus stop duration. -->
			<param name="stopDuration" value="60.0"/>


			<!-- Stop locations file (transit schedule format, but without lines) for DRT stops. Used only for the stopbased mode -->
			<param name="transitStopFile" value="provo_orem_drtstops.xml"/>

			<!-- An XML file specifying the vehicle fleet. The file format according to dvrp_vehicles_v1.dtd -->
			<param name="vehiclesFile" value="drt_vehicles.xml"/>

			<!-- Writes out detailed DRT customer stats in each iteration. True by default. -->
			<param name="writeDetailedCustomerStats" value="true"/>

			<parameterset type="minCostFlowRebalancing">
				<param name="targetAlpha" value="0.5"/>
				<param name="targetBeta" value="0.5"/>
				<param name="cellSize" value="2000"/>
				<param name="interval" value="1800"/>
			</parameterset>
		</parameterset>
	</module>


<module name="network">
    <param name="inputNetworkFile" value="highway_network.xml.gz"/>
    <!-- param name="timeVariantNetwork" value="false" / if timeVariantNetwork -->
		<!-- param name="inputChangeEventsFile" value=""/ if timeVariantNetwork -->
	</module>

	<module name="plans">
		<param name="inputPlansFile" value="final_population.xml"/>
	</module>

	<module name="qsim">
		<param name="simStarttimeInterpretation" value="onlyUseStarttime"/>
		<param name="endTime" value="24:00:00"/>
		<param name="insertingWaitingVehiclesBeforeDrivingVehicles"
			   value="true"/>
		<param name="snapshotStyle" value="queue"/>
	</module>

	<module name="otfvis">
		<param name="coloringScheme" value="taxicab"/>
		<param name="drawNonMovingItems" value="true"/>
	</module>

	<module name="controler">
		<param name="outputDirectory" value="output/provo_orem_stopbased_test"/>
		<param name="overwriteFiles" value="deleteDirectoryIfExists"/>
		<param name="firstIteration" value="0"/>
		<param name="lastIteration" value="20"/>
	</module>

	<module name="planCalcScore">
		<parameterset type="activityParams">
			<param name="activityType" value="work"/>
			<param name="typicalDuration" value="08:00:00"/>
			<param name="openingTime" value="06:00:00"/>
			<param name="latestStartTime" value="09:00:00"/>
			<param name="closingTime" value="17:00:00"/>
		</parameterset>

		<!-- loosely based off of averages of the final trips from activitysim -->

		<param name="activityType_0"            value="Home" /> <!-- home -->
		<param name="activityPriority_0"        value="1" />
		<param name="activityTypicalDuration_0" value="10:00:00" /> <!-- mean is 2 hours?? -->
		<param name="activityMinimalDuration_0" value="06:00:00" />

		<param name="activityType_1"            value="work" /> <!-- work -->
		<param name="activityPriority_1"        value="1" />
		<param name="activityTypicalDuration_1" value="07:30:00" />
		<param name="activityMinimalDuration_1" value="04:00:00" />
		<param name="activityOpeningTime_1"     value="08:00:00" />
		<param name="activityLatestStartTime_1" value="09:00:00" />
		<param name="activityEarliestEndTime_1" value="12:00:00" />
		<param name="activityClosingTime_1"     value="17:00:00" />

		<param name="activityType_2"            value="Work" /> <!-- Work -->
		<param name="activityPriority_2"        value="1" />
		<param name="activityTypicalDuration_2" value="07:30:00" />
		<param name="activityMinimalDuration_2" value="04:00:00" />
		<param name="activityOpeningTime_2"     value="08:00:00" />
		<param name="activityLatestStartTime_2" value="09:00:00" />
		<param name="activityEarliestEndTime_2" value="12:00:00" />
		<param name="activityClosingTime_2"     value="17:00:00" />

		<param name="activityType_3"            value="atwork" /> <!-- at work -->
		<param name="activityPriority_3"        value="1" />
		<param name="activityTypicalDuration_3" value="00:55:00" />

		<param name="activityType_4"            value="shopping" /> <!-- shopping -->
		<param name="activityPriority_4"        value="1" />
		<param name="activityTypicalDuration_4" value="01:05:00" />
		<param name="activityMinimalDuration_4" value="00:12:00" />
		<param name="activityOpeningTime_4"     value="07:00:00" />
		<param name="activityClosingTime_4"     value="22:00:00" />

		<param name="activityType_5"            value="eatout" /> <!-- eating out -->
		<param name="activityPriority_5"        value="1" />
		<param name="activityTypicalDuration_5" value="01:00:00" />
		<param name="activityMinimalDuration_5" value="00:12:00" />
		<param name="activityOpeningTime_5"     value="07:00:00" />
		<param name="activityClosingTime_5"     value="22:00:00" />

		<param name="activityType_6"            value="escort" /> <!-- Pick-up/drop-off passengers -->
		<param name="activityPriority_6"        value="1" />
		<param name="activityTypicalDuration_6" value="00:45:00" />
		<param name="activityMinimalDuration_6" value="00:10:00" />

		<param name="activityType_7"            value="othdiscr" /> <!-- Volunteer work, religious activities -->
		<param name="activityPriority_7"        value="1" />
		<param name="activityTypicalDuration_7" value="02:07:15" />
		<param name="activityMinimalDuration_7" value="00:15:00" />

		<param name="activityType_8"            value="othmaint" /> <!-- Personal business/services and medical appointments -->
		<param name="activityPriority_8"        value="1" />
		<param name="activityTypicalDuration_8" value="01:18:00" />
		<param name="activityMinimalDuration_8" value="00:20:00" />
		<param name="activityOpeningTime_8"     value="08:00:00" />
		<param name="activityClosingTime_8"     value="17:00:00" />

		<param name="activityType_9"            value="school" /> <!-- school -->
		<param name="activityPriority_9"        value="1" />
		<param name="activityTypicalDuration_9" value="07:30:00" />
		<param name="activityOpeningTime_9"     value="07:30:00" />
		<param name="activityClosingTime_9"     value="15:00:00" />

		<param name="activityType_10"            value="univ" /> <!-- university/college -->
		<param name="activityPriority_10"        value="1" />
		<param name="activityTypicalDuration_10" value="05:00:00" />
		<param name="activityOpeningTime_10"     value="07:30:00" />
		<param name="activityClosingTime_10"     value="17:00:00" />

		<param name="activityType_11"            value="social" /> <!-- Recreation, visiting friends/family -->
		<param name="activityPriority_11"        value="1" />
		<param name="activityTypicalDuration_11" value="01:45:00" />
		<param name="activityMinimalDuration_11" value="00:20:00" />

		<parameterset type="modeParams">
			<param name="constant" value="0.0"/>
			<param name="marginalUtilityOfDistance_util_m" value="0.0"/>
			<param name="marginalUtilityOfTraveling_util_hr" value="0.0"/>
			<param name="mode" value="taxi"/>
			<param name="monetaryDistanceRate" value="0.0"/>
		</parameterset>
		<parameterset type="modeParams">
			<param name="constant" value="0.0" />
			<param name="marginalUtilityOfDistance_util_m" value="0.0" />
			<param name="marginalUtilityOfTraveling_util_hr" value="0.0" />
			<param name="mode" value="drt" />
			<param name="monetaryDistanceRate" value="0.0" />
		</parameterset>
	</module>

	<module name="strategy">
		<param name="maxAgentPlanMemorySize" value="5"/>

		<param name="ModuleProbability_1" value="0.8"/>
		<param name="Module_1" value="BestScore"/>

		<param name="ModuleProbability_2" value="0.4"/>
		<param name="Module_2" value="ReRoute"/>

		<param name="ModuleProbability_4" value="0.4"/>
		<param name="Module_4" value="ChangeTripMode"/>

		<param name="ModuleProbability_3" value="0.1"/>
		<param name="Module_3" value="TimeAllocationMutator"/>

		<!--<param name="fractionOfIterationsToDisableInnovation" value="0.8"/>-->
		<!--<parameterset type="strategysettings">
			<param name="strategyName" value="TimeAllocationMutator"/>
			<param name="weight" value="0.1"/>
		</parameterset>-->
	</module>

	<module name="changeMode">
		<param name="modes" value="drt,car,bike,walk,pt,taxi" />
	</module>
	<module name="subtourModeChoice" >
		<!-- Defines the chain-based modes, seperated by commas -->
		<param name="chainBasedModes" value="ride,car,pt,walk,bike,taxi" />
		<!-- Defines whether car availability must be considered or not. A agent has no car only if it has no license, or never access to a car -->
		<param name="considerCarAvailability" value="true" />
		<!-- Defines all the modes available, including chain-based modes, seperated by commas -->
		<param name="modes" value="drt,car,pt,bike,walk,taxi" />
	</module>

	<module name="TimeAllocationMutator">
		<param name="mutationRange" value="900.0"/>
	</module>

</config>
